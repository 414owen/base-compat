Patches are welcome; add tests for new code!

Tested with: `ghc-6.12.3` - `ghc-7.6.1`
