Patches are welcome; add tests for new code!

Tested with:

 * `ghc-7.6.1` / `base-4.6.0.0`
 * `ghc-7.4.2` / `base-4.5.1.0`
 * `ghc-7.4.1` / `base-4.5.0.0`
 * `ghc-7.2.2` / `base-4.4.1.0`
 * `ghc-7.2.1` / `base-4.4.0.0`
 * `ghc-7.0.4` / `base-4.3.1.0`
 * `ghc-7.0.3` / `base-4.3.1.0`
 * `ghc-7.0.2` / `base-4.3.1.0`
 * `ghc-7.0.1` / `base-4.3.0.0`
 * `ghc-6.12.3` / `base-4.2.0.2`
 * `ghc-6.12.2` / `base-4.2.0.1`
