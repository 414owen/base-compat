Patches are welcome; add tests for new code!

Tested with:

 * `ghc-7.6.1` / `base-4.6.0.0`
 * `ghc-7.4.2` / `base-4.5.1.0`
 * `ghc-7.4.1` / `base-4.5.0.0`
 * `ghc-7.2.2` / `base-4.4.1.0`
